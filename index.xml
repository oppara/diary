<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>d.oppara.tv</title><link>https://d.oppara.tv/</link><description>Recent content on d.oppara.tv</description><generator>Hugo -- 0.144.1</generator><language>ja</language><lastBuildDate>Sun, 01 Jun 2025 09:30:25 +0900</lastBuildDate><atom:link href="https://d.oppara.tv/index.xml" rel="self" type="application/rss+xml"/><item><title>シェルスクリプトを使用して、AWS SESでメールを送信する</title><link>https://d.oppara.tv/posts/2025/06/sending-email-by-ses-on-shell-script/</link><pubDate>Sun, 01 Jun 2025 09:30:25 +0900</pubDate><guid>https://d.oppara.tv/posts/2025/06/sending-email-by-ses-on-shell-script/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>シェルスクリプトを使用して、AWS SES でメールを送信する備呆録。&lt;/p>
&lt;h2 id="手順">手順&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#!/usr/bin/env bash
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>set -CEeuo pipefail
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>SES_FROM&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;admin@oppara.tv&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>SES_TO&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;admin@oppara.tv&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>SES_REGION&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;ap-northeast-1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>SES_SUBJECT&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;テストメール from SES&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>SES_BODY&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;ほげほげ&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>aws ses send-email &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --from &lt;span style="color:#e6db74">&amp;#34;&lt;/span>$SES_FROM&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --destination &lt;span style="color:#e6db74">&amp;#34;ToAddresses=&lt;/span>$SES_TO&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --message &lt;span style="color:#e6db74">&amp;#34;Subject={Data=&lt;/span>$SES_SUBJECT&lt;span style="color:#e6db74">,Charset=utf-8},Body={Text={Data=&lt;/span>$SES_BODY&lt;span style="color:#e6db74">,Charset=utf-8}}&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --region &lt;span style="color:#e6db74">&amp;#34;&lt;/span>$SES_REGION&lt;span style="color:#e6db74">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="環境">環境&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>% aws --version
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>aws-cli/2.27.26 Python/3.13.3 Darwin/24.3.0 source/arm64
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>SELinux で httpd からのファイルへのアクセスを許可する</title><link>https://d.oppara.tv/posts/2025/02/selinux-httpd/</link><pubDate>Thu, 20 Feb 2025 22:19:08 +0900</pubDate><guid>https://d.oppara.tv/posts/2025/02/selinux-httpd/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>SELinux で httpd からのファイルへのアクセスを許可する方法の備忘録。&lt;/p>
&lt;h2 id="前提">前提&lt;/h2>
&lt;p>&lt;code>/var/app/tmp&lt;/code> に httpd からアクセスする場合を想定する。&lt;/p>
&lt;h2 id="対応方法">対応方法&lt;/h2>
&lt;pre tabindex="0">&lt;code># chcon -R -t httpd_sys_rw_content_t /var/app/tmp
&lt;/code>&lt;/pre>&lt;p>永続化&lt;/p>
&lt;pre tabindex="0">&lt;code># semanage fcontext -a -t httpd_sys_rw_content_t /var/app/tmp
&lt;/code>&lt;/pre>&lt;p>確認&lt;/p>
&lt;pre tabindex="0">&lt;code># ls -alFZ /var/app/tmp
&lt;/code>&lt;/pre>&lt;h2 id="参考サイト">参考サイト&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://scrapbox.io/tech-notes/SELinux%E3%81%A7Apache%E3%81%8B%E3%82%89%E3%81%AE%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%B8%E3%81%AE%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%82%92%E8%A8%B1%E5%8F%AF%E3%81%99%E3%82%8B">SELinuxでApacheからのファイルへのアクセスを許可する - tech-notes&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="環境">環境&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>$ cat /etc/system-release
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Amazon Linux release 2023.6.20250123 (Amazon Linux)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>PHP リトライのテンプレート</title><link>https://d.oppara.tv/posts/2025/01/php-retry/</link><pubDate>Mon, 13 Jan 2025 10:37:19 +0900</pubDate><guid>https://d.oppara.tv/posts/2025/01/php-retry/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>よく忘れるので、備呆録。&lt;/p>
&lt;h2 id="手順">手順&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-php" data-lang="php">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#a6e22e">php&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">declare&lt;/span>(&lt;span style="color:#a6e22e">strict_types&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">retry&lt;/span>($retries, $sleep, &lt;span style="color:#a6e22e">callable&lt;/span> $callback)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> ($i &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>; $i &lt;span style="color:#f92672">&amp;lt;=&lt;/span> $retries; $i&lt;span style="color:#f92672">++&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">try&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> $callback();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">catch&lt;/span> (&lt;span style="color:#a6e22e">Exception&lt;/span> $e) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">echo&lt;/span> &lt;span style="color:#e6db74">&amp;#34;attempt: &lt;/span>&lt;span style="color:#e6db74">$i&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#a6e22e">PHP_EOL&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">echo&lt;/span> $e&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#a6e22e">getMessage&lt;/span>() &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#a6e22e">PHP_EOL&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $delay &lt;span style="color:#f92672">=&lt;/span> $sleep &lt;span style="color:#f92672">*&lt;/span> $i;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">echo&lt;/span> &lt;span style="color:#e6db74">&amp;#34;delay: &lt;/span>&lt;span style="color:#e6db74">$delay&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#a6e22e">PHP_EOL&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">sleep&lt;/span>($delay);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">throw&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">Exception&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;Failed after &amp;#39;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> $retries &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#e6db74">&amp;#39; retries&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">hoge&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">throw&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">Exception&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;error&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">retry&lt;/span>(&lt;span style="color:#ae81ff">3&lt;/span>, &lt;span style="color:#ae81ff">1&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;hoge&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="環境">環境&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% sw_vers
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ProductName: macOS
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ProductVersion: 15.2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>BuildVersion: 24C101
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>% php -v
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>PHP 8.2.27 (cli) (built: Dec 17 2024 11:39:23) (NTS)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Copyright (c) The PHP Group
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Zend Engine v4.2.27, Copyright (c) Zend Technologies
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> with Zend OPcache v8.2.27, Copyright (c), by Zend Technologies
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Fluentd で dry-run</title><link>https://d.oppara.tv/posts/2025/01/fluentd-dry-run/</link><pubDate>Sun, 12 Jan 2025 10:08:21 +0900</pubDate><guid>https://d.oppara.tv/posts/2025/01/fluentd-dry-run/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>&lt;a href="https://www.fluentd.org/">Fluentd&lt;/a> で設定ファイルを確認する方法についての備呆録。&lt;/p>
&lt;h2 id="cli">CLI&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% fluentd --dry-run -c /etc/fluentd/fluent.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="docker">Docker&lt;/h2>
&lt;p>プラグイン使っている場合は、あらかじめインストールしておく必要がある。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% docker run &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>-ti --rm \
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>--platform linux/x86_64 \
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>-v ./:/fluentd/etc -v ./:/var/log \
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>fluent/fluentd:v1.8-debian-1 --dry-run -c /fluentd/etc/hoge.conf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>fluentd --dry-run -c /fluentd/etc/hoge.conf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>2025-01-12 09:07:29 +0000 [info]: parsing config file is succeeded path=&amp;#34;/fluentd/etc/hoge.conf&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>2025-01-12 09:07:29 +0000 [info]: gem &amp;#39;fluentd&amp;#39; version &amp;#39;1.8.1&amp;#39;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>2025-01-12 09:07:29 +0000 [info]: starting fluentd-1.8.1 as dry run mode ruby=&amp;#34;2.6.5&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>2025-01-12 09:07:29 +0000 [info]: using configuration file: &amp;lt;ROOT&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;source&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> @type tail
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> path &amp;#34;/var/log/httpd-access.log&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> pos_file &amp;#34;/var/log/td-agent/httpd-access.log.pos&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> tag &amp;#34;s3.apache.access&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;parse&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> @type &amp;#34;apache2&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;/parse&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;/source&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;match log.**&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> @type file
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> path &amp;#34;/var/log/fluent/myapp&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> compress gzip
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;buffer&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> timekey 1d
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> timekey_use_utc true
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> timekey_wait 10m
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> path &amp;#34;/var/log/fluent/myapp&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;/buffer&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;/match&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/ROOT&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>2025-01-12 09:07:29 +0000 [info]: finsihed dry run mode
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="環境">環境&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% sw_vers
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ProductName: macOS
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ProductVersion: 15.2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>BuildVersion: 24C101
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>% docker --version
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Docker version 27.4.0, build bde2b89
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>MySQL ですべてのテーブルを削除する</title><link>https://d.oppara.tv/posts/2024/10/mysql-drop-all-table/</link><pubDate>Thu, 31 Oct 2024 23:07:37 +0900</pubDate><guid>https://d.oppara.tv/posts/2024/10/mysql-drop-all-table/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>MySQL でデータベース内のすべてのテーブルを削除する方法の備忘録。&lt;/p>
&lt;h2 id="手順">手順&lt;/h2>
&lt;p>DROP 文を作成して実行する。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>$ echo &lt;span style="color:#e6db74">&amp;#34;SET FOREIGN_KEY_CHECKS = 0;&amp;#34;&lt;/span> &amp;gt; /patht/to/tmp.sql
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ mysqldump -h $DB_HOST --single-transaction --add-drop-table --no-data -u $DB_USER -p $DB_NAME | grep &lt;span style="color:#e6db74">&amp;#39;DROP TABLE&amp;#39;&lt;/span> &amp;gt;&amp;gt; /path/to/tmp.sql
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ echo &lt;span style="color:#e6db74">&amp;#34;SET FOREIGN_KEY_CHECKS = 1;&amp;#34;&lt;/span> &amp;gt;&amp;gt; /path/to/tmp.sql
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>$ mysql -h $DB_HOST -u $DB_USER -p $DB_NAME &amp;lt; /path/to/tmp.sql
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>運用中で指定した名前の EC2 のプライベートアドレスを取得する</title><link>https://d.oppara.tv/posts/2024/09/aws-ec2-describe-private-ip/</link><pubDate>Mon, 02 Sep 2024 23:40:15 +0900</pubDate><guid>https://d.oppara.tv/posts/2024/09/aws-ec2-describe-private-ip/</guid><description>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>TARGET_TAG&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;hoge&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>aws ec2 describe-instances &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --filter &lt;span style="color:#e6db74">&amp;#34;Name=instance-state-name,Values=running&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Name=tag:Name,Values=&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>TARGET_TAG&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> | jq -r &lt;span style="color:#e6db74">&amp;#39;.Reservations[].Instances[] | .PrivateIpAddress &amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>ec2:DescribeInstances&lt;/code>ポリシーが必要。&lt;/p>
&lt;h2 id="環境">環境&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>$ aws --version
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>aws-cli/2.17.41 Python/3.11.9 Linux/6.1.102-111.182.amzn2023.x86_64 exec-env/CloudShell exe/x86_64.amzn.2023
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>1 秒に 1 回サーバにアクセスするコマンド</title><link>https://d.oppara.tv/posts/2024/06/curl-per-second/</link><pubDate>Thu, 06 Jun 2024 08:18:07 +0900</pubDate><guid>https://d.oppara.tv/posts/2024/06/curl-per-second/</guid><description>&lt;h2 id="使いどころ">使いどころ&lt;/h2>
&lt;p>例えば、サーバのアップグレード時に、実際に通信が途切れてないか 1 秒に 1 回サーバにアクセスして接続を確認したい時とか。&lt;/p>
&lt;h2 id="手順">手順&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>url=https://oppara.tv/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>while true; do TZ=JST-9 date; curl -I &amp;#34;$url&amp;#34;; sleep 1s; done
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Mac の場合&lt;/p></description></item><item><title>WordPress の管理画面でチェックされたカテゴリーが上に表示されるのを抑止する</title><link>https://d.oppara.tv/posts/2024/05/wp-terms-checked-ontop/</link><pubDate>Wed, 29 May 2024 20:07:35 +0900</pubDate><guid>https://d.oppara.tv/posts/2024/05/wp-terms-checked-ontop/</guid><description>&lt;h2 id="問題">問題&lt;/h2>
&lt;p>WordPress の管理画面でカテゴリーをチェックすると、そのカテゴリーが上に表示されるのを止めたい。&lt;/p>
&lt;h2 id="対応方法">対応方法&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-php" data-lang="php">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">add_filter&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;wp_terms_checklist_args&amp;#39;&lt;/span>, &lt;span style="color:#66d9ef">function&lt;/span>($args) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $args[&lt;span style="color:#e6db74">&amp;#39;checked_ontop&amp;#39;&lt;/span>] &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">false&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> $args;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>});
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="参考サイト">参考サイト&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://liginc.co.jp/programmer/archives/2931">WordPressの設置の際に気を配りたい。カテゴリーの階層構造について | 株式会社LIG(リグ)｜DX支援・システム開発・Web制作&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="環境">環境&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% wp core version
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>6.5.3
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Zabbix `Disk space is low` トリガーの条件</title><link>https://d.oppara.tv/posts/2024/05/zabbix-disk-space-is-low/</link><pubDate>Thu, 02 May 2024 17:00:19 +0900</pubDate><guid>https://d.oppara.tv/posts/2024/05/zabbix-disk-space-is-low/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>Zabbix のトリガー &lt;code>/: Disk space is low&lt;/code> の条件の備呆録&lt;/p>
&lt;h2 id="-disk-space-is-low-トリガーの条件">&lt;code>/: Disk space is low&lt;/code> トリガーの条件&lt;/h2>
&lt;pre tabindex="0">&lt;code>last(/oppara.tv/vfs.fs.size[/,pused])&amp;gt;{$VFS.FS.PUSED.MAX.WARN:&amp;#34;/&amp;#34;} and ((last(/oppara.tv/vfs.fs.size[/,total])-last(/oppara.tv/vfs.fs.size[/,used]))&amp;lt;{$VFS.FS.FREE.MIN.WARN:&amp;#34;/&amp;#34;} or timeleft(/oppara.tv/vfs.fs.size[/,pused],1h,100)&amp;lt;1d)
&lt;/code>&lt;/pre>&lt;p>見やすく整形してみる。&lt;/p>
&lt;pre tabindex="0">&lt;code>last(/oppara.tv/vfs.fs.size[/, pused]) &amp;gt; {$VFS.FS.PUSED.MAX.WARN:&amp;#34;/&amp;#34;}
and
(
(last(/oppara.tv/vfs.fs.size[/, total]) - last(/oppara.tv/vfs.fs.size[/, used])) &amp;lt; {$VFS.FS.FREE.MIN.WARN:&amp;#34;/&amp;#34;}
or
timeleft(/oppara.tv/vfs.fs.size[/, pused], 1h, 100) &amp;lt; 1d
)
&lt;/code>&lt;/pre>&lt;p>日本語にしてみる。&lt;/p></description></item><item><title>openssl を使って証明書を確認</title><link>https://d.oppara.tv/posts/2024/02/check-certificate-using-openssl/</link><pubDate>Sat, 17 Feb 2024 00:19:31 +0900</pubDate><guid>https://d.oppara.tv/posts/2024/02/check-certificate-using-openssl/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>openssl を使って証明書の諸々を確認する方法の備忘録。&lt;/p>
&lt;h2 id="証明書のコモンネームと有効開始日有効期限日を確認する">証明書のコモンネームと有効開始日・有効期限日を確認する&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% openssl x509 -noout -subject -dates -in oppara.tv.crt
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>subject=CN=oppara.tv
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>notBefore=Jan 31 19:06:53 2024 GMT
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>notAfter=Apr 30 19:06:52 2024 GMT
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="証明書と秘密鍵の整合性を確認する">証明書と秘密鍵の「整合性」を確認する&lt;/h2>
&lt;p>ハッシュが同じであれば整合性が取れている。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% openssl x509 -noout -modulus -in oppara.tv.cert | md5sum
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>48f8be8df2822b4f302fc16276566f9e -
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>% openssl rsa -noout -modulus -in oppara.tv.key | md5sum
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>48f8be8df2822b4f302fc16276566f9e -
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="証明書と中間証明書の整合性を確認する">証明書と中間証明書の「整合性」を確認する&lt;/h2>
&lt;p>ハッシュが同じであれば整合性が取れている。&lt;/p></description></item><item><title>Intel One Mono を使う</title><link>https://d.oppara.tv/posts/2024/01/font-intel-one-mono/</link><pubDate>Mon, 29 Jan 2024 07:21:41 +0900</pubDate><guid>https://d.oppara.tv/posts/2024/01/font-intel-one-mono/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>中括弧（{}）が特徴的な、&lt;a href="https://github.com/intel/intel-one-mono">Intel One Mono&lt;/a> を使ってみる。&lt;/p>
&lt;p>&lt;figure>
&lt;img loading="lazy" src="font.png"/>
&lt;/figure>
&lt;figure>
&lt;img loading="lazy" src="typeface.png"/>
&lt;/figure>
&lt;/p>
&lt;h2 id="インストール">インストール&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% install homebrew/cask-fonts/font-intel-one-mono
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="環境">環境&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% sw_vers
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ProductName: macOS
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ProductVersion: 14.2.1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>BuildVersion: 23C71
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>% brew --version
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Homebrew 4.2.5
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>AWS CLIからテストメールを送信</title><link>https://d.oppara.tv/posts/2024/01/aws-ses-cli-send-email/</link><pubDate>Sat, 27 Jan 2024 14:55:28 +0900</pubDate><guid>https://d.oppara.tv/posts/2024/01/aws-ses-cli-send-email/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>AWS CLIからテストメールを送信する方法を備忘録。&lt;/p>
&lt;h2 id="手順">手順&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>$ to&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;test@example.com&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ aws ses send-email &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --from info@oppara.tv \
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> --to &amp;#34;${to}&amp;#34; \
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> --subject &amp;#34;件名&amp;#34; \
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> --text &amp;#34;本文&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="環境">環境&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>$ aws --version
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>aws-cli/2.15.13 Python/3.11.6 Linux/6.1.66-91.160.amzn2023.x86_64 exec-env/CloudShell exe/x86_64.amzn.2023 prompt/off
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>ローカルで Web サーバーを立てる</title><link>https://d.oppara.tv/posts/2024/01/localserver/</link><pubDate>Wed, 10 Jan 2024 08:57:54 +0900</pubDate><guid>https://d.oppara.tv/posts/2024/01/localserver/</guid><description>&lt;h2 id="nodejs">Node.js&lt;/h2>
&lt;pre tabindex="0">&lt;code>npx serve
&lt;/code>&lt;/pre>&lt;p>port 指定する場合。&lt;/p>
&lt;pre tabindex="0">&lt;code>npx serve -p 1192
&lt;/code>&lt;/pre>&lt;p>&lt;a href="https://www.npmjs.com/package/serve">serve - npm&lt;/a>&lt;/p>
&lt;h2 id="python">Python&lt;/h2>
&lt;pre tabindex="0">&lt;code>python -m http.server 1192
&lt;/code>&lt;/pre>&lt;p>&lt;a href="https://docs.python.org/ja/3.10/library/http.server.html">http.server &amp;mdash; HTTP サーバ — Python 3.10.13 ドキュメント&lt;/a>&lt;/p>
&lt;h2 id="php">PHP&lt;/h2>
&lt;pre tabindex="0">&lt;code>php -S localhost:1192
&lt;/code>&lt;/pre>&lt;p>&lt;a href="https://www.php.net/manual/ja/features.commandline.webserver.php">PHP: ビルトインウェブサーバー - Manual&lt;/a>&lt;/p>
&lt;h2 id="まとめ">まとめ&lt;/h2>
&lt;p>静的コンテンツは node で。PHP が絡む場合は php で。&lt;/p></description></item><item><title>CLI で Aurora Serverless V1 を作成する</title><link>https://d.oppara.tv/posts/2023/11/aws-aurora-serverless-v1/</link><pubDate>Sat, 25 Nov 2023 10:33:23 +0900</pubDate><guid>https://d.oppara.tv/posts/2023/11/aws-aurora-serverless-v1/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>マネジメントコンソールで Aurora Serverless V1 を作成できないので、AWS CLI の覚書。&lt;/p>
&lt;h2 id="手順">手順&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>DATABASE_NAME&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;try_db&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>DB_CLUSTER_IDENTIFIER&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;try-cluster&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>VPC_SECURITY_GROUP_IDS&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;sg-016afba3d02181db5&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>MASTER_USERNAME&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;admin&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>MASTER_USER_PASSWORD&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;p4ssw0rd&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>DB_SUBNET_GROUP_NAME&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;try-db-subnet-group&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>aws rds create-db-cluster &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --database-name &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>DATABASE_NAME&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --db-cluster-identifier &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>DB_CLUSTER_IDENTIFIER&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --vpc-security-group-ids &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>VPC_SECURITY_GROUP_IDS&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --master-username &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>MASTER_USERNAME&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --master-user-password &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>MASTER_USER_PASSWORD&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --db-subnet-group-name &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>DB_SUBNET_GROUP_NAME&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --availability-zones ap-northeast-1a ap-northeast-1c ap-northeast-1d &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --engine aurora-mysql &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --engine-version 5.7.mysql_aurora.2.08.3 &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --engine-mode serverless &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --scaling-configuration &lt;span style="color:#e6db74">&amp;#39;{&amp;#34;MinCapacity&amp;#34;:1,&amp;#34;MaxCapacity&amp;#34;:2,&amp;#34;AutoPause&amp;#34;:true,&amp;#34;SecondsUntilAutoPause&amp;#34;:300,&amp;#34;TimeoutAction&amp;#34;:&amp;#34;ForceApplyCapacityChange&amp;#34;,&amp;#34;SecondsBeforeTimeout&amp;#34;:60}&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="参考">参考&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://docs.aws.amazon.com/ja_jp/AmazonRDS/latest/AuroraUserGuide/aurora-serverless.create.html">Aurora Serverless v1 DB クラスターの作成 - Amazon Aurora&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://awscli.amazonaws.com/v2/documentation/api/latest/reference/rds/create-db-cluster.html">create-db-cluster — AWS CLI 2.13.38 Command Reference&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="環境">環境&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>$ aws --version
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>aws-cli/2.13.35 Python/3.11.6 Linux/6.1.59-84.139.amzn2023.x86_64 exec-env/CloudShell exe/x86_64.amzn.2 prompt/off
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Next.js で Basic 認証をかける</title><link>https://d.oppara.tv/posts/2023/11/nextjs-basic-auth/</link><pubDate>Mon, 20 Nov 2023 06:32:13 +0900</pubDate><guid>https://d.oppara.tv/posts/2023/11/nextjs-basic-auth/</guid><description>&lt;h2 id="対応方法">対応方法&lt;/h2>
&lt;p>middleware を使用する。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-typescript:middleware.ts" data-lang="typescript:middleware.ts">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// middleware.ts
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">import&lt;/span> { &lt;span style="color:#a6e22e">NextResponse&lt;/span>, &lt;span style="color:#a6e22e">NextRequest&lt;/span> } &lt;span style="color:#66d9ef">from&lt;/span> &lt;span style="color:#e6db74">&amp;#39;next/server&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">export&lt;/span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">config&lt;/span> &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// /hoge/ 以下のパスに対して Basic 認証をかける
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#a6e22e">matcher&lt;/span>&lt;span style="color:#f92672">:&lt;/span> [&lt;span style="color:#e6db74">&amp;#39;/hoge/:path*&amp;#39;&lt;/span>],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">export&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">middleware&lt;/span>(&lt;span style="color:#a6e22e">req&lt;/span>: &lt;span style="color:#66d9ef">NextRequest&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">basicAuth&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">headers&lt;/span>.&lt;span style="color:#66d9ef">get&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;authorization&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#a6e22e">basicAuth&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">authValue&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">basicAuth&lt;/span>.&lt;span style="color:#a6e22e">split&lt;/span>(&lt;span style="color:#e6db74">&amp;#39; &amp;#39;&lt;/span>)[&lt;span style="color:#ae81ff">1&lt;/span>];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> [&lt;span style="color:#a6e22e">user&lt;/span>, &lt;span style="color:#a6e22e">password&lt;/span>] &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">atob&lt;/span>(&lt;span style="color:#a6e22e">authValue&lt;/span>).&lt;span style="color:#a6e22e">split&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;:&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#a6e22e">user&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#a6e22e">process&lt;/span>.&lt;span style="color:#a6e22e">env&lt;/span>.&lt;span style="color:#a6e22e">BASIC_AUTH_USER&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#a6e22e">password&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#a6e22e">process&lt;/span>.&lt;span style="color:#a6e22e">env&lt;/span>.&lt;span style="color:#a6e22e">BASIC_AUTH_PASSWORD&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">NextResponse&lt;/span>.&lt;span style="color:#a6e22e">next&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">NextResponse&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;Unauthorized&amp;#39;&lt;/span>, {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">status&lt;/span>: &lt;span style="color:#66d9ef">401&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">headers&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;WWW-Authenticate&amp;#39;&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;Basic realm=&amp;#34;Secure Area&amp;#34;&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># .env.local&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>BASIC_AUTH_USER&lt;span style="color:#f92672">=&lt;/span>foo
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>BASIC_AUTH_PASSWORD&lt;span style="color:#f92672">=&lt;/span>bar
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="環境">環境&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% npx next -v
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Next.js v14.0.3
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Next.js で IP アドレスを使用したアクセス制限を行う</title><link>https://d.oppara.tv/posts/2023/11/nextjs-restrict-access-by-ip-address/</link><pubDate>Mon, 20 Nov 2023 06:22:12 +0900</pubDate><guid>https://d.oppara.tv/posts/2023/11/nextjs-restrict-access-by-ip-address/</guid><description>&lt;h2 id="対応方法">対応方法&lt;/h2>
&lt;p>middleware を使用する。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-typescript:middleware.ts" data-lang="typescript:middleware.ts">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// middleware.ts
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">import&lt;/span> { &lt;span style="color:#a6e22e">NextResponse&lt;/span>, &lt;span style="color:#a6e22e">NextRequest&lt;/span> } &lt;span style="color:#66d9ef">from&lt;/span> &lt;span style="color:#e6db74">&amp;#39;next/server&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">validAddresses&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">Set&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#a6e22e">process&lt;/span>.&lt;span style="color:#a6e22e">env&lt;/span>.&lt;span style="color:#a6e22e">VALID_IP_ADDRESSES&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">process&lt;/span>.&lt;span style="color:#a6e22e">env&lt;/span>.&lt;span style="color:#a6e22e">VALID_IP_ADDRESSES&lt;/span>&lt;span style="color:#f92672">!&lt;/span>.&lt;span style="color:#a6e22e">split&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;,&amp;#39;&lt;/span>).&lt;span style="color:#a6e22e">forEach&lt;/span>((&lt;span style="color:#a6e22e">address&lt;/span>) &lt;span style="color:#f92672">=&amp;gt;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">validAddresses&lt;/span>.&lt;span style="color:#a6e22e">add&lt;/span>(&lt;span style="color:#a6e22e">address&lt;/span>.&lt;span style="color:#a6e22e">trim&lt;/span>());
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> })
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">export&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">middleware&lt;/span>(&lt;span style="color:#a6e22e">req&lt;/span>: &lt;span style="color:#66d9ef">NextRequest&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> &lt;span style="color:#a6e22e">ip&lt;/span>: &lt;span style="color:#66d9ef">string&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">ip&lt;/span> &lt;span style="color:#f92672">??&lt;/span> &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">headers&lt;/span>.&lt;span style="color:#66d9ef">get&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;x-real-ip&amp;#39;&lt;/span>) &lt;span style="color:#f92672">??&lt;/span> &lt;span style="color:#e6db74">&amp;#39;&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// with CDN or LB or next dev
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#a6e22e">ip&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">headers&lt;/span>.&lt;span style="color:#66d9ef">get&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;x-forwarded-for&amp;#39;&lt;/span>)) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">ip&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">headers&lt;/span>.&lt;span style="color:#66d9ef">get&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;x-forwarded-for&amp;#39;&lt;/span>)&lt;span style="color:#f92672">?&lt;/span>.&lt;span style="color:#a6e22e">split&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;,&amp;#39;&lt;/span>)[&lt;span style="color:#ae81ff">0&lt;/span>] &lt;span style="color:#f92672">??&lt;/span> &lt;span style="color:#e6db74">&amp;#39;&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#a6e22e">validAddresses&lt;/span>.&lt;span style="color:#a6e22e">has&lt;/span>(&lt;span style="color:#a6e22e">ip&lt;/span>)) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">tmp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">status&lt;/span>: &lt;span style="color:#66d9ef">403&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">url&lt;/span>: &lt;span style="color:#66d9ef">req.url&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">host&lt;/span>: &lt;span style="color:#66d9ef">req.nextUrl.host&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#a6e22e">JSON&lt;/span>.&lt;span style="color:#a6e22e">stringify&lt;/span>(&lt;span style="color:#a6e22e">tmp&lt;/span>));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">NextResponse&lt;/span>(&lt;span style="color:#66d9ef">null&lt;/span>, { &lt;span style="color:#a6e22e">status&lt;/span>: &lt;span style="color:#66d9ef">401&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">NextResponse&lt;/span>.&lt;span style="color:#a6e22e">next&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># .env.local&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>VALID_IP_ADDRESSES&lt;span style="color:#f92672">=&lt;/span>127.0.0.1,::1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="環境">環境&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% npx next -v
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Next.js v14.0.3
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>ログローテートの覚書</title><link>https://d.oppara.tv/posts/2023/11/logrotate/</link><pubDate>Mon, 06 Nov 2023 10:53:51 +0900</pubDate><guid>https://d.oppara.tv/posts/2023/11/logrotate/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>ログローテートの dry-run、実行方法についての覚書。&lt;/p>
&lt;h2 id="usage">Usage&lt;/h2>
&lt;p>dry-run 実行&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>logrotate -d /etc/logrotate.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>実行&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>logrotate -f /etc/logrotate.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>設定ファイルを指定して実行&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>logrotate -f /etc/logrotate.d/httpd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>textlint で dry run</title><link>https://d.oppara.tv/posts/2023/10/textlint-dryrun/</link><pubDate>Thu, 19 Oct 2023 07:33:30 +0900</pubDate><guid>https://d.oppara.tv/posts/2023/10/textlint-dryrun/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>&lt;a href="https://textlint.github.io/">textlint&lt;/a> の dry-run をよく忘れるので覚書。
そもそもデフォルトが dry-run だった。&lt;/p>
&lt;h2 id="usage">Usage&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>npx textlint /path/to/target
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>キャッシュなし、設定ファイル指定の場合。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>npx textlint --no-cache -c /path/to/textlintrc /path/to/target
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>自動修正時の場合。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>npx textlint --dry-run --fix /path/to/target
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="環境">環境&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% npx textlint --version
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>v13.3.3
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>% sw_vers
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ProductName: macOS
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ProductVersion: 14.0
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>BuildVersion: 23A344
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>stree を使ってみる</title><link>https://d.oppara.tv/posts/2023/10/aws-s3-stree/</link><pubDate>Mon, 09 Oct 2023 10:24:59 +0900</pubDate><guid>https://d.oppara.tv/posts/2023/10/aws-s3-stree/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>便利そうなので使ってみる。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/orangekame3/stree">orangekame3/stree: 📁Directory trees of AWS S3 Bucket&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://future-architect.github.io/articles/20230926a/">stree：S3バケットをtreeするCLIコマンド | フューチャー技術ブログ&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="インストール">インストール&lt;/h2>
&lt;p>Homebrew でインストールする。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% brew install orangekame3/tap/stree
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="ちょいはまる">ちょい、はまる。&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% stree my-bucket
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ignoring argument my-bucket (path check I)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>No Git or Mercurial URLs found in arguments or current working path, see stree --help
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>は？&lt;/p></description></item><item><title>シェルスクリプトで Usage 表示</title><link>https://d.oppara.tv/posts/2023/10/shellscript-usage/</link><pubDate>Thu, 05 Oct 2023 22:22:24 +0900</pubDate><guid>https://d.oppara.tv/posts/2023/10/shellscript-usage/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>簡易敵な Usage 表示&lt;/p>
&lt;h2 id="実装">実装&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#!/usr/bin/env bash
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75715e">#/ Usage:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#/ awsome-script [-h | -help] &amp;lt;name&amp;gt; [&amp;lt;count&amp;gt;]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#/ Example&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#/ awsome-script foo&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#/ awsome-script foo 3&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>set -e
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>usage &lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> grep &lt;span style="color:#e6db74">&amp;#39;^#/&amp;#39;&lt;/span> &amp;lt; &lt;span style="color:#e6db74">&amp;#34;&lt;/span>$0&lt;span style="color:#e6db74">&amp;#34;&lt;/span> | cut -c4-
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> exit &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#f92672">[&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&lt;/span>$1&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;--help&amp;#34;&lt;/span> &lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">[&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&lt;/span>$1&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;-h&amp;#34;&lt;/span> &lt;span style="color:#f92672">]&lt;/span>; &lt;span style="color:#66d9ef">then&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> usage
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>NAME&lt;span style="color:#f92672">=&lt;/span>$1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>COUNT&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>2&lt;span style="color:#66d9ef">:-&lt;/span>0&lt;span style="color:#e6db74">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>echo &lt;span style="color:#e6db74">&amp;#34;&lt;/span>$NAME&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&lt;/span>$COUNT&lt;span style="color:#e6db74">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="実行">実行&lt;/h2>
&lt;pre tabindex="0">&lt;code>% /path/to/awsome-script -h
Usage:
awsome-script [-h | -help] &amp;lt;name&amp;gt; [&amp;lt;count&amp;gt;]
Example
awsome-script foo
awsome-script foo 3
% /path/to/awsome-script foo
foo 0
&lt;/code>&lt;/pre></description></item><item><title>Postfix 覚書</title><link>https://d.oppara.tv/posts/2023/10/postfix-setting/</link><pubDate>Tue, 03 Oct 2023 22:11:39 +0900</pubDate><guid>https://d.oppara.tv/posts/2023/10/postfix-setting/</guid><description>&lt;h2 id="主要な項目の説明">主要な項目の説明&lt;/h2>
&lt;ul>
&lt;li>myhostname：DNS で正引きできる（A レコードが存在する）ホスト名。&lt;br>
DNS 正引きの IP アドレスと、Postfix を設定するサーバの IP アドレスが一致する必要はない！&lt;/li>
&lt;li>mydomain：ドメイン名を FQDN で指定&lt;/li>
&lt;li>myorigin：アプリケーションからのメール送信時に From アドレスのドメインとして使用する名前&lt;/li>
&lt;/ul>
&lt;p>最終的に、myorigin に設定するドメインに、逆引き、SPF レコードの設定が必要。&lt;/p></description></item><item><title>www ありなしの RewiteRule</title><link>https://d.oppara.tv/posts/2023/09/rewrite-rule-www/</link><pubDate>Fri, 22 Sep 2023 00:02:37 +0900</pubDate><guid>https://d.oppara.tv/posts/2023/09/rewrite-rule-www/</guid><description>&lt;h2 id="www-ありの-https-のurlに統一">www ありの https のURLに統一&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-apache" data-lang="apache">&lt;span style="display:flex;">&lt;span>RewriteEngine &lt;span style="color:#66d9ef">on&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>RewriteCond %{HTTPS} &lt;span style="color:#66d9ef">off&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>RewriteCond %{HTTP_HOST} !^www\. [NC]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>RewriteRule ^(.*)$ http://www.%{HTTP_HOST}/$1 [R=301,L]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="www-なしの-https-のurlに統一">www なしの https のURLに統一&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-apache" data-lang="apache">&lt;span style="display:flex;">&lt;span>RewriteEngine &lt;span style="color:#66d9ef">on&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>RewriteCond %{HTTPS} &lt;span style="color:#66d9ef">off&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>RewriteCond %{HTTP_HOST} ^www\.(.*) [NC]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>RewriteRule ^ http://%1%{REQUEST_URI} [L,R=301]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>WordPress の管理画面でプラグインの URL を取得する</title><link>https://d.oppara.tv/posts/2023/07/wp-admin-plugin-url/</link><pubDate>Tue, 18 Jul 2023 09:31:09 +0900</pubDate><guid>https://d.oppara.tv/posts/2023/07/wp-admin-plugin-url/</guid><description>&lt;h2 id="目的">目的&lt;/h2>
&lt;p>WordPress の管理画面で独自プラグインの URL を取得したい。&lt;/p>
&lt;h2 id="対応方法">対応方法&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-php" data-lang="php">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">funtcion&lt;/span> &lt;span style="color:#a6e22e">getPluginUrl&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">admin_url&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;admin.php?page=&amp;#39;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#a6e22e">プラグインのスラッグ&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>WordPress でスラッグにスラッシュを含ませたい</title><link>https://d.oppara.tv/posts/2023/05/wp-slug-with-slash/</link><pubDate>Sat, 20 May 2023 18:18:23 +0900</pubDate><guid>https://d.oppara.tv/posts/2023/05/wp-slug-with-slash/</guid><description>&lt;h2 id="問題">問題&lt;/h2>
&lt;p>WordPress でスラッグにスラッシュを含ませられない。&lt;br>
スラッシュがハイフンに変換されてしまう。。。&lt;/p>
&lt;h2 id="対応方法">対応方法&lt;/h2>
&lt;p>&lt;a href="https://github.com/WordPress/WordPress/blob/6.2.2/wp-includes/formatting.php#L2258">sanitize_title_with_dashes&lt;/a> という関数でフィルタしてるので削除する。&lt;/p>
&lt;p>ただし、フィルタを削除すると、&lt;a href="https://github.com/WordPress/WordPress/blob/6.2.2/wp-includes/formatting.php#L2267-L2272">URI エンコード&lt;/a> されなくなるので自前でエンコードする。&lt;/p></description></item><item><title>WordPress で外観メニュー内に「メニュー」表示されない件</title><link>https://d.oppara.tv/posts/2023/05/wp-themes-menu/</link><pubDate>Fri, 19 May 2023 14:27:10 +0900</pubDate><guid>https://d.oppara.tv/posts/2023/05/wp-themes-menu/</guid><description>&lt;h2 id="問題">問題&lt;/h2>
&lt;p>自分で作成したテーマを使用した場合、サイドメニュー -&amp;gt; 外観メニュー内に「メニュー」が表示されない。&lt;/p>
&lt;h2 id="対応方法">対応方法&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-php" data-lang="php">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">add_action&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;after_setup_theme&amp;#39;&lt;/span>, &lt;span style="color:#66d9ef">function&lt;/span>()&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">void&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">register_nav_menu&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;primary&amp;#39;&lt;/span>, &lt;span style="color:#a6e22e">__&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;Primary Menu&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;theme-slug&amp;#39;&lt;/span>));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>});
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>シェルスクリプトでディレクトリ名やファイル名を取得したい</title><link>https://d.oppara.tv/posts/2023/05/shellscript-dirname-filename/</link><pubDate>Tue, 02 May 2023 00:43:57 +0900</pubDate><guid>https://d.oppara.tv/posts/2023/05/shellscript-dirname-filename/</guid><description>&lt;h2 id="目的">目的&lt;/h2>
&lt;p>よく忘れるので備忘録。&lt;/p>
&lt;p>よく使うのは &lt;code>##*/&lt;/code>, &lt;code>%/*&lt;/code>&lt;/p>
&lt;h2 id="パターン">パターン&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>パターン&lt;/th>
&lt;th>説明&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>${var#pattern}&lt;/td>
&lt;td>var の先頭から pattern の最短一致を削除する。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>${var##pattern}&lt;/td>
&lt;td>var の先頭から pattern の最長一致を削除する。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>${var%pattern}&lt;/td>
&lt;td>var の末尾から pattern の最短一致を削除する。&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>${var%%pattern}&lt;/td>
&lt;td>var の末尾から pattern の最長一致を削除する。&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#!/bin/sh
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>path&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;/etc/httpd/httpd.conf&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ファイル名&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>echo &lt;span style="color:#e6db74">${&lt;/span>path##*/&lt;span style="color:#e6db74">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ディレクトリ名&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>echo &lt;span style="color:#e6db74">${&lt;/span>path%/*&lt;span style="color:#e6db74">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 拡張子を除いたファイル名&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>echo &lt;span style="color:#e6db74">${&lt;/span>path%.*&lt;span style="color:#e6db74">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 拡張子&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>echo &lt;span style="color:#e6db74">${&lt;/span>path##*.&lt;span style="color:#e6db74">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Neovim のインストール</title><link>https://d.oppara.tv/posts/2023/04/neovim-install/</link><pubDate>Thu, 27 Apr 2023 08:29:24 +0900</pubDate><guid>https://d.oppara.tv/posts/2023/04/neovim-install/</guid><description>&lt;h2 id="目的">目的&lt;/h2>
&lt;p>Neovim を使いたい。&lt;/p>
&lt;h2 id="対応方法">対応方法&lt;/h2>
&lt;p>&lt;a href="https://brew.sh/">Homebrew&lt;/a> でインストールする。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>brew install neovim
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>開発バージョンをインストールする。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>brew install --HEAD neovim
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>開発バージョンをアップデートする。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>brew upgrade neovim --fetch-HEAD
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="参考サイト">参考サイト&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://github.com/neovim/neovim/wiki/Installing-Neovim#macos--os-x">Installing Neovim · neovim/neovim Wiki&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="環境">環境&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% nvim --version
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>NVIM v0.9.0
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Build type: Release
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>LuaJIT 2.1.0-beta3
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>% sw_vers
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ProductName: macOS
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ProductVersion: 13.3
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>BuildVersion: 22E252
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>XDG Base Directory のデフォルト値まとめ</title><link>https://d.oppara.tv/posts/2023/04/xdg-base-directory/</link><pubDate>Wed, 26 Apr 2023 23:49:07 +0900</pubDate><guid>https://d.oppara.tv/posts/2023/04/xdg-base-directory/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>XDG_ほにゃららの環境変数のデフォルト値を忘れてしまうのでまとめ。&lt;/p>
&lt;h2 id="まとめ">まとめ&lt;/h2>
&lt;h3 id="xdg_config_home">XDG_CONFIG_HOME&lt;/h3>
&lt;p>ユーザー個別の設定が書き込まれるディレクトリ。&lt;/p>
&lt;pre tabindex="0">&lt;code>echo &amp;#34;${XDG_CONFIG_HOME:-$HOME/.config}&amp;#34;
&lt;/code>&lt;/pre>&lt;h3 id="xdg_data_home">XDG_DATA_HOME&lt;/h3>
&lt;p>ユーザー個別のデータファイルが書き込まれるディレクトリ。&lt;/p></description></item><item><title>GitLab に登録している公開鍵を取得したい</title><link>https://d.oppara.tv/posts/2022/10/gitlab-pubkey/</link><pubDate>Fri, 07 Oct 2022 09:00:03 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/10/gitlab-pubkey/</guid><description>&lt;h2 id="目的">目的&lt;/h2>
&lt;p>GitLab に登録している公開鍵を手軽に取得したい。&lt;/p>
&lt;h2 id="対応方法">対応方法&lt;/h2>
&lt;p>GitLab のユーザーページの URL の後ろに &lt;code>.keys&lt;/code> をつける。&lt;/p>
&lt;h3 id="例">例&lt;/h3>
&lt;ul>
&lt;li>GitLab のホスト: gitlab.oppara.tv&lt;/li>
&lt;li>ユーザー名: oppara&lt;/li>
&lt;/ul>
&lt;pre tabindex="0">&lt;code>% curl https://gitlab.oppara.tv/oppara.keys
&lt;/code>&lt;/pre>&lt;h2 id="参考サイト">参考サイト&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://blog.id774.net/entry/2013/12/16/441/">GitHub に登録した SSH 公開鍵は全世界に公開されている | 774::Blog&lt;/a>&lt;/li>
&lt;/ul>
&lt;pre tabindex="0">&lt;code>% curl https://github.com/oppara.keys
&lt;/code>&lt;/pre></description></item><item><title>APG4b を Mac 上で確認したい</title><link>https://d.oppara.tv/posts/2022/09/apgb-mac/</link><pubDate>Sat, 24 Sep 2022 22:12:03 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/09/apgb-mac/</guid><description>&lt;h2 id="目的">目的&lt;/h2>
&lt;p>&lt;a href="https://atcoder.jp/contests/apg4b">C++入門 AtCoder Programming Guide for beginners (APG4b)&lt;/a> の解答を Mac 上で確認したい。&lt;/p>
&lt;h2 id="対応方法">対応方法&lt;/h2>
&lt;p>以下のファイルを作成して&lt;br>
~/apg4b/include/bits/stdc++.h&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;iostream&amp;gt;&lt;/span>&lt;span style="color:#75715e"> &lt;/span>&lt;span style="color:#75715e">// cout, endl, cin
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;string&amp;gt;&lt;/span>&lt;span style="color:#75715e"> &lt;/span>&lt;span style="color:#75715e">// string, to_string, stoi
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;vector&amp;gt;&lt;/span>&lt;span style="color:#75715e"> &lt;/span>&lt;span style="color:#75715e">// vector
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;algorithm&amp;gt;&lt;/span>&lt;span style="color:#75715e"> &lt;/span>&lt;span style="color:#75715e">// min, max, swap, sort, reverse, lower_bound, upper_bound
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;utility&amp;gt;&lt;/span>&lt;span style="color:#75715e"> &lt;/span>&lt;span style="color:#75715e">// pair, make_pair
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;tuple&amp;gt;&lt;/span>&lt;span style="color:#75715e"> &lt;/span>&lt;span style="color:#75715e">// tuple, make_tuple
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;cstdint&amp;gt;&lt;/span>&lt;span style="color:#75715e"> &lt;/span>&lt;span style="color:#75715e">// int64_t, int*_t
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;cstdio&amp;gt;&lt;/span>&lt;span style="color:#75715e"> &lt;/span>&lt;span style="color:#75715e">// printf
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;map&amp;gt;&lt;/span>&lt;span style="color:#75715e"> &lt;/span>&lt;span style="color:#75715e">// map
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;queue&amp;gt;&lt;/span>&lt;span style="color:#75715e"> &lt;/span>&lt;span style="color:#75715e">// queue, priority_queue
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;set&amp;gt;&lt;/span>&lt;span style="color:#75715e"> &lt;/span>&lt;span style="color:#75715e">// set
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;stack&amp;gt;&lt;/span>&lt;span style="color:#75715e"> &lt;/span>&lt;span style="color:#75715e">// stack
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;deque&amp;gt;&lt;/span>&lt;span style="color:#75715e"> &lt;/span>&lt;span style="color:#75715e">// deque
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;unordered_map&amp;gt;&lt;/span>&lt;span style="color:#75715e"> &lt;/span>&lt;span style="color:#75715e">// unordered_map
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;unordered_set&amp;gt;&lt;/span>&lt;span style="color:#75715e"> &lt;/span>&lt;span style="color:#75715e">// unordered_set
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;bitset&amp;gt;&lt;/span>&lt;span style="color:#75715e"> &lt;/span>&lt;span style="color:#75715e">// bitset
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;cctype&amp;gt;&lt;/span>&lt;span style="color:#75715e"> &lt;/span>&lt;span style="color:#75715e">// isupper, islower, isdigit, toupper, tolower
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>パスに追加しておく。&lt;/p></description></item><item><title>VPN 接続しても IP アドレスが変わらない件</title><link>https://d.oppara.tv/posts/2022/09/mac-vpn/</link><pubDate>Sun, 04 Sep 2022 09:14:43 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/09/mac-vpn/</guid><description>&lt;h2 id="問題">問題&lt;/h2>
&lt;p>Mac で会社の VPN 設定をしても、IP アドレスが会社のものに切り替わらない。&lt;/p>
&lt;h2 id="対応方法">対応方法&lt;/h2>
&lt;ol>
&lt;li>「システム環境設定」 -&amp;gt; 「ネットワーク」で設定した VPN 設定の [詳細&amp;hellip;] ボタンをクリック&lt;/li>
&lt;li>「オプション」タブ内の「すべてのトラフィックを VPN 接続経由で送信」をチェック&lt;/li>
&lt;/ol>
&lt;p>&lt;img loading="lazy" src="https://d.oppara.tv/posts/2022/09/mac-vpn/vpn.png">&lt;/p></description></item><item><title>Trivy で AWS のセキュリティスキャンを行う</title><link>https://d.oppara.tv/posts/2022/08/aws-trivy/</link><pubDate>Sun, 21 Aug 2022 07:45:32 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/08/aws-trivy/</guid><description>&lt;h2 id="やり方">やり方&lt;/h2>
&lt;p>aws-vault を利用し、EC2 のセキュリティスキャンを行う場合。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% aws-vault exec opp-dev -- trivy aws --service ec2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="ヘルプ">ヘルプ&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% trivy aws --help
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="参考サイト">参考サイト&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://dev.classmethod.jp/articles/aws-security-scan-by-trivy/">TrivyでAWSアカウントのセキュリティスキャンができるようになりました | DevelopersIO&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="環境">環境&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% sw_vers
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ProductName: macOS
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ProductVersion: 12.4
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>BuildVersion: 21F79
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>% trivy --version
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Version: 0.31.2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>DynamoDB をローカル環境で使いたい</title><link>https://d.oppara.tv/posts/2022/06/aws-dynamodb-local/</link><pubDate>Tue, 28 Jun 2022 07:26:34 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/06/aws-dynamodb-local/</guid><description>&lt;h2 id="目的">目的&lt;/h2>
&lt;p>DynamoDB をローカル環境で使いたい。&lt;/p>
&lt;h2 id="対応方法">対応方法&lt;/h2>
&lt;p>&lt;a href="https://docs.aws.amazon.com/ja_jp/amazondynamodb/latest/developerguide/DynamoDBLocal.DownloadingAndRunning.html#docker">DynamoDB ローカルを Docker で動かす&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml:docker-compose.yaml" data-lang="yaml:docker-compose.yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">version&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;3.8&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">services&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dynamodb-local&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">command&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;-jar DynamoDBLocal.jar -sharedDb -dbPath ./data&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">image&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;amazon/dynamodb-local:latest&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">container_name&lt;/span>: &lt;span style="color:#ae81ff">dynamodb-local&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ports&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#34;8888:8000&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">volumes&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#34;./docker/dynamodb:/home/dynamodblocal/data&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">working_dir&lt;/span>: &lt;span style="color:#ae81ff">/home/dynamodblocal&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="起動">起動&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% docker-compose up -d
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="テーブルを作成してみる">テーブルを作成してみる&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% export AWS_DEFAULT_REGION&lt;span style="color:#f92672">=&lt;/span>us-west-2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% export ENDPOINT&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;http://localhost:8888&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>% aws dynamodb create-table &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --table-name sessions \
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> --endpoint-url &amp;#34;${ENDPOINT}&amp;#34; \
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> --attribute-definitions \
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> AttributeName=id,AttributeType=S \
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> --key-schema \
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> AttributeName=id,KeyType=HASH \
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> --billing-mode PAY_PER_REQUEST \
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> --table-class STANDARD
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="環境">環境&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% sw_vers
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ProductName: macOS
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ProductVersion: 12.4
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>BuildVersion: 21F79
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Wrangler で Cloudflare Workers</title><link>https://d.oppara.tv/posts/2022/05/wrangler-cloudflare-workers/</link><pubDate>Tue, 17 May 2022 22:08:35 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/05/wrangler-cloudflare-workers/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>&lt;a href="https://developers.cloudflare.com/workers/wrangler/">Wrangler（Workers CLI）&lt;/a>を使って &lt;a href="https://developers.cloudflare.com/workers/">Cloudflare Workers&lt;/a> を試してみる。&lt;/p>
&lt;h2 id="wrangler-のインストール">Wrangler のインストール&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% npm install -g wrangler
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="cloudflare-の認証">Cloudflare の認証&lt;/h2>
&lt;p>2 段階認証にもたもたしてたらタイムアウトしてしまった。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% wrangler login
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ⛅️ wrangler 2.0.5
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>-------------------
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Attempting to login via OAuth...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>✘ [ERROR] Timed out waiting for authorization code, please try again.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>もう一度。&lt;/p></description></item><item><title>npx 実行時に Ok to proceed? (y) と表示させない</title><link>https://d.oppara.tv/posts/2022/05/npx-not-show-ok-to-proceed/</link><pubDate>Tue, 10 May 2022 21:28:23 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/05/npx-not-show-ok-to-proceed/</guid><description>&lt;h2 id="問題">問題&lt;/h2>
&lt;p>npx 実行時に&lt;code>y&lt;/code>とたたくのが面倒、もしくはたたくこと自体を忘れてしまう。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% npx cowsay foo
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Need to install the following packages:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cowsay
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Ok to proceed? (y)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="対応方法">対応方法&lt;/h2>
&lt;p>&lt;code>--yes&lt;/code>をつける。(キャッシュを有効にする?)&lt;/p></description></item><item><title>Brewfile を上書きしたい</title><link>https://d.oppara.tv/posts/2022/04/brew-bundle-dump/</link><pubDate>Wed, 27 Apr 2022 22:58:54 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/04/brew-bundle-dump/</guid><description>&lt;h2 id="目的">目的&lt;/h2>
&lt;p>Brewfile コメント付きで上書きしたい。&lt;/p>
&lt;h2 id="やり方">やり方&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% brew bundle dump --force --describe
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="ヘルプ表示">ヘルプ表示&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% brew bundle --help
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="環境">環境&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% brew --version
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Homebrew 3.4.8-11-g96e8796
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Homebrew/homebrew-core (git revision 44fc63c8cca; last commit 2022-04-25)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Homebrew/homebrew-cask (git revision 659584ba8c; last commit 2022-04-26)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>% sw_vers
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ProductName: macOS
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ProductVersion: 12.3.1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>BuildVersion: 21E258
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>AWS CLI で証明書の再インポート</title><link>https://d.oppara.tv/posts/2022/04/aws-acm-import-certificate/</link><pubDate>Tue, 26 Apr 2022 09:22:58 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/04/aws-acm-import-certificate/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>マネコンからの再インポートが面倒くさかったので備忘録。&lt;/p>
&lt;h2 id="対応方法">対応方法&lt;/h2>
&lt;p>シェルスクリプトから実行する。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>set -eu
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># インポートする証明書の ARN&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ARN&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;arn:aws:acm:region:123456789012:certificate/12345678-1234-1234-1234-12345678901 &amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 証明書ファイルへのパス&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>CRT&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;Certificate.pem&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 中間証明書ファイルへのパス&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>CC&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;CertificateChain.pem&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># パスワード無しの秘密鍵へのパス&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>KEY&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;PrivateKey.pem&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># リージョン&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>REGION&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;us-east-1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>aws acm import-certificate &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --certificate fileb://&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>CRT&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --certificate-chain fileb://&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>CC&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --private-key fileb://&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>KEY&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --certificate-arn &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>ARN&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --region &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>REGION&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="参考サイト">参考サイト&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://docs.aws.amazon.com/ja_jp/acm/latest/userguide/import-reimport.html">証明書を再インポートする - AWS Certificate Manager&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://awscli.amazonaws.com/v2/documentation/api/latest/reference/acm/import-certificate.html">import-certificate — AWS CLI 2.5.8 Command Reference&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="環境">環境&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% aws --version
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>aws-cli/2.5.8 Python/3.9.12 Darwin/21.4.0 source/x86_64 prompt/off
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>WP-CLI でテーブル内の文字列を置換する</title><link>https://d.oppara.tv/posts/2022/04/wp-search-replace/</link><pubDate>Mon, 11 Apr 2022 21:52:05 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/04/wp-search-replace/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>&lt;a href="https://wp-cli.org/ja/">WP-CLI&lt;/a> でテーブル内の文字列を置換する。&lt;/p>
&lt;h2 id="やり方">やり方&lt;/h2>
&lt;p>プレフィックスが&lt;code>wp_&lt;/code>のテーブル内の&lt;code>search&lt;/code>を&lt;code>replace&lt;/code>に置換して&lt;code>out&lt;/code>に書き出す。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>set -eu
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>path&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;wp-config.php があるディレクトリまでのパス&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>search&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;https://stg.example.com&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>replace&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;https://www.example.com&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>out&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;export.sql&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/path/to/wp search-replace --path&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>path&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>search&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>replace&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span> wp_* &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>--export&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>out&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>--report-changed-only &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>--all-tables-with-prefix
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>--export&lt;/code>をつけない場合はテーブルのデータをじかに置換するので、実行前に&lt;code>--dry-run&lt;/code>を忘れない。&lt;/p></description></item><item><title>メール送信ワンライナー</title><link>https://d.oppara.tv/posts/2022/04/mail-one-liner/</link><pubDate>Fri, 08 Apr 2022 13:04:15 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/04/mail-one-liner/</guid><description>&lt;h2 id="目的">目的&lt;/h2>
&lt;p>mail コマンドで対話的にメールを送るのが面倒だったので備忘録。&lt;/p>
&lt;h2 id="対応方法">対応方法&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% echo &lt;span style="color:#e6db74">&amp;#34;本文&amp;#34;&lt;/span> | mail -s &lt;span style="color:#e6db74">&amp;#34;件名&amp;#34;&lt;/span> -r no-replay@example.com foo@oppara.tv bar@oppara.tv
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="環境">環境&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>$ mail -V
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>12.5 7/5/10
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>$ cat /etc/os-release
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>NAME=&amp;#34;Rocky Linux&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>VERSION=&amp;#34;8.5 (Green Obsidian)&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ID=&amp;#34;rocky&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ID_LIKE=&amp;#34;rhel centos fedora&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>VERSION_ID=&amp;#34;8.5&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>PLATFORM_ID=&amp;#34;platform:el8&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>PRETTY_NAME=&amp;#34;Rocky Linux 8.5 (Green Obsidian)&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ANSI_COLOR=&amp;#34;0;32&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>CPE_NAME=&amp;#34;cpe:/o:rocky:rocky:8:GA&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>HOME_URL=&amp;#34;https://rockylinux.org/&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>BUG_REPORT_URL=&amp;#34;https://bugs.rockylinux.org/&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ROCKY_SUPPORT_PRODUCT=&amp;#34;Rocky Linux&amp;#34;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ROCKY_SUPPORT_PRODUCT_VERSION=&amp;#34;8&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>GitHub Actions 時でなくてもブランチ名を利用したい</title><link>https://d.oppara.tv/posts/2022/04/github-actions-git-branch/</link><pubDate>Sun, 03 Apr 2022 00:04:44 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/04/github-actions-git-branch/</guid><description>&lt;h2 id="目的">目的&lt;/h2>
&lt;p>Actions 時に呼び出すシェルスクリプト内で、Actions 時でなくてもブランチ名を利用したい。&lt;/p>
&lt;h2 id="対応方法">対応方法&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>set -Ceu
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#f92672">[&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>GITHUB_REF_NAME&lt;span style="color:#66d9ef">:-&lt;/span>UNDEF&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;UNDEF&amp;#34;&lt;/span> &lt;span style="color:#f92672">]&lt;/span>; &lt;span style="color:#66d9ef">then&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> GITHUB_REF_NAME&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">$(&lt;/span>git rev-parse --abbrev-ref HEAD&lt;span style="color:#66d9ef">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">fi&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="参考サイト">参考サイト&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://docs.github.com/ja/actions/learn-github-actions/environment-variables">環境変数 - GitHub Docs&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>GitLab CI 時でなくてもブランチ名を利用したい</title><link>https://d.oppara.tv/posts/2022/04/gitlab-ci-git-branch/</link><pubDate>Sat, 02 Apr 2022 22:50:07 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/04/gitlab-ci-git-branch/</guid><description>&lt;h2 id="目的">目的&lt;/h2>
&lt;p>CI 時に呼び出すシェルスクリプト内で、CI 時でなくてもブランチ名を利用したい。&lt;/p>
&lt;h2 id="対応方法">対応方法&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>set -Ceu
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#f92672">[&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>CI_COMMIT_REF_NAME&lt;span style="color:#66d9ef">:-&lt;/span>UNDEF&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;UNDEF&amp;#34;&lt;/span> &lt;span style="color:#f92672">]&lt;/span>; &lt;span style="color:#66d9ef">then&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> CI_COMMIT_REF_NAME&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">$(&lt;/span>git rev-parse --abbrev-ref HEAD&lt;span style="color:#66d9ef">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">## 以下の書き方は GitLab 16.0 以降使えなくなる&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># if [ &amp;#34;${CI_BUILD_REF_NAME:-UNDEF}&amp;#34; = &amp;#34;UNDEF&amp;#34; ]; then&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># CI_BUILD_REF_NAME=$(git rev-parse --abbrev-ref HEAD)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># fi&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="bash-のオプション">bash のオプション&lt;/h2>
&lt;ul>
&lt;li>&lt;code>C&lt;/code>: リダイレクト時に既存のファイルを上書きしない。&lt;/li>
&lt;li>&lt;code>e&lt;/code>: コマンドがゼロ以外のステータスを返した場合、スクリプトを即座に終了する。&lt;/li>
&lt;li>&lt;code>u&lt;/code>: 未定義の変数を参照時にエラー。&lt;/li>
&lt;/ul>
&lt;h2 id="参考サイト">参考サイト&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://docs.gitlab.com/ee/update/deprecations.html#ci_build_-predefined-variables">Deprecations by milestone | GitLab&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Windows で rsync を使いたい</title><link>https://d.oppara.tv/posts/2022/03/windows-rsync/</link><pubDate>Mon, 28 Mar 2022 23:48:44 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/03/windows-rsync/</guid><description>&lt;h2 id="問題">問題&lt;/h2>
&lt;p>Windows で rsync を使いたい。
でも WSL を使うほどでもない。&lt;/p>
&lt;h2 id="対応方法">対応方法&lt;/h2>
&lt;p>Git for Windows に rsync をインストールする。&lt;/p>
&lt;ol>
&lt;li>スタートメニューの「Git Bash」を右クリックして、「管理者として実行」する。&lt;/li>
&lt;li>以下のシェルスクリプトを実行する。&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#!/usr/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>set -eu
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>curl -L http://repo.msys2.org/msys/x86_64/zstd-1.4.5-2-x86_64.pkg.tar.xz |tar CvxJf / -
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>curl -L http://repo.msys2.org/msys/x86_64/rsync-3.2.2-2-x86_64.pkg.tar.zst |tar Cxvf / - --zstd
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>curl -L http://repo.msys2.org/msys/x86_64/libzstd-1.4.5-2-x86_64.pkg.tar.xz |tar CxvJf / -
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>curl -L http://repo.msys2.org/msys/x86_64/libxxhash-0.8.0-1-x86_64.pkg.tar.zst |tar Cvxf / - --zstd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="参考サイト">参考サイト&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://zenn.dev/miwarin/articles/14a10b3278e7a6">Git for Windows に rsync を追加する&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="環境">環境&lt;/h2>
&lt;ul>
&lt;li>Windows 10 21H2 (OS ビルド 19044, 1586)&lt;/li>
&lt;li>Git for Windows 2.35.1&lt;/li>
&lt;li>rsync version 3.2.2 protocol version 31&lt;/li>
&lt;/ul></description></item><item><title>Chrome を使っているとファンがうるさい</title><link>https://d.oppara.tv/posts/2022/03/chrome-fan-solution/</link><pubDate>Sun, 27 Mar 2022 10:01:24 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/03/chrome-fan-solution/</guid><description>&lt;h2 id="問題">問題&lt;/h2>
&lt;p>Chrome を使うとファンがうなりを上げる。&lt;/p>
&lt;h2 id="対応方法">対応方法&lt;/h2>
&lt;ol>
&lt;li>&lt;code>chrome://flags/#enhanced-bookmarks-experiment&lt;/code>を開く。&lt;/li>
&lt;li>&lt;code>bookmark&lt;/code>で検索。&lt;/li>
&lt;li>以下の機能を Disabled に変更する。
&lt;ul>
&lt;li>Omnibox short bookmark suggestions&lt;/li>
&lt;li>Omnibox Bookmark Paths&lt;/li>
&lt;li>Omnibox Site Search Starter Pack&lt;/li>
&lt;li>Reading List&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Chrome を再起動する。&lt;/li>
&lt;/ol>
&lt;h2 id="参考サイト">参考サイト&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://nldot.info/chrome-slow-fix/">2022年 重たいChromeを軽くする意外な解決方法とは？ | オランダで生きていく&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="環境">環境&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>% /Applications/Google&lt;span style="color:#ae81ff">\ &lt;/span>Chrome.app/Contents/MacOS/Google&lt;span style="color:#ae81ff">\ &lt;/span>Chrome --version
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Google Chrome 99.0.4844.83
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>% sw_vers
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ProductName: macOS
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ProductVersion: 12.2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>BuildVersion: 21D49
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Bash 変数文字列置換</title><link>https://d.oppara.tv/posts/2022/03/bash-string-replacement/</link><pubDate>Thu, 24 Mar 2022 22:45:36 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/03/bash-string-replacement/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>よく使う変数内文字列置換を忘れるのでのメモ。&lt;/p>
&lt;h2 id="例">例&lt;/h2>
&lt;p>&lt;code>~/tmp/hoge.sh&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>echo &lt;span style="color:#e6db74">&amp;#34;&lt;/span>$0&lt;span style="color:#e6db74">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># basename&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>echo &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>0##*/&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 拡張子取得&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>echo &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>0##*&lt;span style="color:#ae81ff">\.&lt;/span>&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># dirname&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>echo &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>0%/*&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 拡張子以外&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>echo &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>0%.*&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>output&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>/Users/oppara/tmp/hoge.sh
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>hoge.sh
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sh
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/Users/oppara/tmp
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/Users/oppara/tmp/hoge
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="環境">環境&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% sw_vers
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ProductName: macOS
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ProductVersion: 12.2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>BuildVersion: 21D49
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>% bash --version
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>GNU bash, version 3.2.57(1)-release (x86_64-apple-darwin21)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Copyright (C) 2007 Free Software Foundation, Inc.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Pandoc マークダウンを PDF に変換しようとしてエラー</title><link>https://d.oppara.tv/posts/2022/03/pandoc-markdown-pdf-error/</link><pubDate>Tue, 22 Mar 2022 12:46:21 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/03/pandoc-markdown-pdf-error/</guid><description>&lt;h2 id="問題">問題&lt;/h2>
&lt;p>マークダウンを PDF に変換しようとすると以下のエラー。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% pandoc hoge.md -o hoge.pdf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>pandoc: pdflatex: createProcess: posix_spawnp: illegal operation (Inappropriate ioctl for device)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="対応方法">対応方法&lt;/h2>
&lt;p>&lt;a href="https://wkhtmltopdf.org/">wkhtmltopdf&lt;/a> を使ってみる。&lt;/p>
&lt;p>wkhtmltopdf のインストール。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% brew install --cask wkhtmltopdf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>マークダウンを PDF に変換する。&lt;/p></description></item><item><title>AWS CLI で AWS Backup を利用した EC2 のバックアップ設定をする</title><link>https://d.oppara.tv/posts/2022/03/aws-backup-ec2-cli/</link><pubDate>Mon, 21 Mar 2022 18:13:28 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/03/aws-backup-ec2-cli/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>AWS CLI で AWS Backup を利用した EC2 のバックアップ設定の備忘録。&lt;/p>
&lt;h2 id="デフォルトのロールの作成">デフォルトのロールの作成&lt;/h2>
&lt;p>1 つもバックアッププランがない状態で、cli 経由でバックリソースを作成した場合、デフォルトのロール ( AWSBackupDefaultServiceRole ) は自動で作成されないので注意。&lt;br>
（マネコンからバックアップリソース作成時、IAM ロールで「デフォルトのロール」を選択した場合はデフォルトのロールが作成される）&lt;/p></description></item><item><title>EC2インスタンスのタグとプライベートIPアドレスを表示する</title><link>https://d.oppara.tv/posts/2022/03/aws-ec2-describe-ipaddress/</link><pubDate>Sat, 19 Mar 2022 22:59:39 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/03/aws-ec2-describe-ipaddress/</guid><description>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#!/usr/bin/env bash
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>set -e
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>desc&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">while&lt;/span> read -r line
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">do&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> set &lt;span style="color:#e6db74">${&lt;/span>line&lt;span style="color:#e6db74">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> name&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>1&lt;span style="color:#e6db74">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ip&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>2&lt;span style="color:#e6db74">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> echo &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>name&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">: &lt;/span>&lt;span style="color:#e6db74">${&lt;/span>ip&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">done&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>aws ec2 describe-instances --filter &lt;span style="color:#e6db74">&amp;#34;Name=instance-state-name,Values=running&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> | jq -r &lt;span style="color:#e6db74">&amp;#39;.Reservations[].Instances[] | [(.Tags[] | select(.Key==&amp;#34;Name&amp;#34;).Value), .PrivateIpAddress] | @tsv&amp;#39;&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> | desc
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>ec2:DescribeInstances&lt;/code>ポリシーが必要。&lt;/p></description></item><item><title>Bash 変数のデフォルト値を設定する</title><link>https://d.oppara.tv/posts/2022/03/bash-default-value/</link><pubDate>Fri, 18 Mar 2022 08:37:01 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/03/bash-default-value/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>変数のデフォルト値の設定をを忘れるのでのメモ。&lt;/p>
&lt;h2 id="例">例&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># var には代入されない&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>echo &lt;span style="color:#e6db74">&amp;#34;hello &lt;/span>&lt;span style="color:#e6db74">${&lt;/span>var&lt;span style="color:#66d9ef">:-&lt;/span>world&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>echo &lt;span style="color:#e6db74">&amp;#34;&lt;/span>$var&lt;span style="color:#e6db74">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># デフォルト値を変数化するときは再代入した方が楽&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>var&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>var&lt;span style="color:#66d9ef">:-&lt;/span>foo&lt;span style="color:#e6db74">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>echo &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>var&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>output&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-consle" data-lang="consle">hello world
foo
&lt;/code>&lt;/pre>&lt;h2 id="環境">環境&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% sw_vers
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ProductName: macOS
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ProductVersion: 12.2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>BuildVersion: 21D49
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>% bash --version
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>GNU bash, version 3.2.57(1)-release (x86_64-apple-darwin21)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Copyright (C) 2007 Free Software Foundation, Inc.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>AWS Vault を使って MFA と AssumeRole（スイッチロール）</title><link>https://d.oppara.tv/posts/2022/03/aws-vault-assumerole-mfa/</link><pubDate>Thu, 17 Mar 2022 23:01:07 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/03/aws-vault-assumerole-mfa/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>AWS Vault を使って MFA 経由で AssumeRole する備忘録。&lt;/p>
&lt;p>&lt;a href="https://github.com/99designs/aws-vault">99designs/aws-vault&lt;/a>&lt;/p>
&lt;h2 id="前提">前提&lt;/h2>
&lt;p>以下のアカウントを作成済みでスイッチロールの設定済み。&lt;/p>
&lt;ul>
&lt;li>oppara (default): スイッチ元 (MFA 認証)&lt;/li>
&lt;li>oppara-dev: スイッチ先&lt;/li>
&lt;/ul>
&lt;h2 id="対応方法">対応方法&lt;/h2>
&lt;h3 id="aws-vault-のインストール">AWS Vault のインストール&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% brew cask install aws-vault
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="accesskeyid-secretaccesskey-をキーチェーンに登録">AccessKeyId, SecretAccessKey をキーチェーンに登録&lt;/h3>
&lt;p>AWS Vault で生成するキーチェーンにアクセスする為のパスワード入力するダイアログが表示されるので設定する。&lt;/p></description></item><item><title>Session Manager で Amazon Linux にログイン後ユーザーを切り替える</title><link>https://d.oppara.tv/posts/2022/03/aws-ssm-switch-user/</link><pubDate>Wed, 16 Mar 2022 22:31:09 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/03/aws-ssm-switch-user/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>Session Manager で EC2 上の Amazon Linux にログイン後、他のユーザーになるための備忘録。&lt;/p>
&lt;p>ログイン時は&lt;code>ssm-user&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>sh-4.2$ whoami
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ssm-user
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="対応方法">対応方法&lt;/h2>
&lt;h3 id="ec2-user-になる">ec2-user になる&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>sh-4.2$ sudo su --login ec2-user
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="root-になる">root になる&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>sh-4.2$ sudo su --login
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="環境">環境&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>sh-4.2$ cat /etc/system-release
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Amazon Linux release 2 (Karoo)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>sh-4.2$ amazon-ssm-agent -version
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>SSM Agent version: 3.0.1124.0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>git log のエイリアス</title><link>https://d.oppara.tv/posts/2022/03/git-log-alias/</link><pubDate>Tue, 15 Mar 2022 21:59:21 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/03/git-log-alias/</guid><description>&lt;h2 id="問題">問題&lt;/h2>
&lt;p>&lt;code>git log&lt;/code>の表示が寂しい。&lt;/p>
&lt;h2 id="対応">対応&lt;/h2>
&lt;p>好みのログを表示するエイリアスを設定する。&lt;/p>
&lt;h3 id="git-のエイリアス">Git のエイリアス&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-ini" data-lang="ini">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">; ~/.gitconfig&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">[alias]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">ll&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">log --graph --color \
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> --pretty=format:&amp;#39;%C(red)%x09%h %C(yellow)%cn %C(green)%ci %C(reset)%s%C(blue)%d%C(reset)&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;table>
&lt;thead>
&lt;tr>
&lt;th>format&lt;/th>
&lt;th>解説&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>%C(red)%x09%h&lt;/code>&lt;/td>
&lt;td>9 文字空けて省略されたコミットハッシュを赤で表示&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>%C(yellow)%cn&lt;/code>&lt;/td>
&lt;td>コミッターの名前を黄色で表示&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>%C(green)%ci&lt;/code>&lt;/td>
&lt;td>コミットした日時を ISO8601 ぽい形式で緑で表示&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>%C(reset)%s&lt;/code>&lt;/td>
&lt;td>表示色をリセットし、件名（コミットメッセージの 1 行目）を表示&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>%C(blue)%d%C(reset)&lt;/code>&lt;/td>
&lt;td>ref name を青で表示し、再度表示色をリセット&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>本家の解説ページ&lt;br>
&lt;a href="https://git-scm.com/docs/pretty-formats">Git - pretty-formats Documentation&lt;/a>&lt;/p></description></item><item><title>Speedtest の CLI クライアントを試してみる</title><link>https://d.oppara.tv/posts/2022/03/cli-speedtest/</link><pubDate>Mon, 14 Mar 2022 21:16:06 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/03/cli-speedtest/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>&lt;a href="https://www.speedtest.net/">speedtest.net&lt;/a> の &lt;a href="https://www.speedtest.net/apps/cli">CLI クライアント&lt;/a> があったので試してみる。&lt;/p>
&lt;h2 id="インストール">インストール&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% brew install teamookla/speedtest/speedtest
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="初回実行">初回実行&lt;/h2>
&lt;p>初回実行時は、ライセンスの確認がある。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% speedtest
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>====================================================================
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>You may only use this Speedtest software and information generated
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>from it for personal, non-commercial use, through a command line
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>interface on a personal computer. Your use of this software is subject
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>to the End User License Agreement, Terms of Use and Privacy Policy at
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>these URLs:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span> https://www.speedtest.net/about/eula
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> https://www.speedtest.net/about/terms
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> https://www.speedtest.net/about/privacy
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>=====================================================================
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>Do you accept the license? [type YES to accept]:
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="サーバ選択の詳細を表示しながら実行">サーバ選択の詳細を表示しながら実行&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% speedtest --selection-details
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span> Speedtest by Ookla
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>Selecting server:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 20976: 6.24 ms; GLBB Japan - Tokyo
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 21569: 5.66 ms; i3D.net - Tokyo
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 38241: 5.51 ms; BudgetVM - Tokyo
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 28910: 212.52 ms; fdcservers.net - Tokyo
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 48301: 5.96 ms; Cloudflare - Tokyo
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 24333: 17.89 ms; Rakuten Mobile, Inc - Tokyo
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 44988: 7.02 ms; Misaka Network, Inc. - Tokyo
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 48463: 5.79 ms; IPA CyberLab 400G - Tokyo
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 14623: 6.14 ms; IPA CyberLab - Bunkyo
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 8407: 10.31 ms; Allied Telesis Capital Corporation - Sagamihara
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Server: BudgetVM - Tokyo (id = 38241)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ISP: Softbank BB
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Latency: 5.63 ms (0.76 ms jitter)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Download: 117.23 Mbps (data used: 124.7 MB)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Upload: 230.65 Mbps (data used: 134.4 MB)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Packet Loss: 0.0%
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Result URL: https://www.speedtest.net/result/c/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="サーバ-id-を指定して実行">サーバ ID を指定して実行&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% speedtest -s &lt;span style="color:#ae81ff">21569&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span> Speedtest by Ookla
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span> Server: i3D.net - Tokyo (id = 21569)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ISP: Softbank BB
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Latency: 5.61 ms (0.40 ms jitter)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Download: 110.67 Mbps (data used: 69.7 MB)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Upload: 219.27 Mbps (data used: 145.6 MB)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Packet Loss: 0.0%
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Result URL: https://www.speedtest.net/result/c/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="環境">環境&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% sw_vers
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ProductName: macOS
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ProductVersion: 12.2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>BuildVersion: 21D49
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>% speedtest -V
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Speedtest by Ookla 1.1.1.84 (3bdba79799) Darwin 21.3.0 x86_64
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>yaml, toml, json, hclの変換ツール yj</title><link>https://d.oppara.tv/posts/2022/03/cli-yaml-toml-json-hcl-converter/</link><pubDate>Sun, 13 Mar 2022 21:46:57 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/03/cli-yaml-toml-json-hcl-converter/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>yaml から toml への変換ツールを探していて良さげなものを発見したので使ってみる。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/sclevine/yj">sclevine/yj: CLI - Convert between YAML, TOML, JSON, and HCL&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="インストール">インストール&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% brew install yj
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="使い方">使い方&lt;/h2>
&lt;p>標準入力から読み込ませてリダイレクトする感じ。&lt;/p></description></item><item><title>Hugo で作成した記事を GitHub Pages で公開する</title><link>https://d.oppara.tv/posts/2022/03/hugo-github-pages/</link><pubDate>Sat, 12 Mar 2022 16:08:15 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/03/hugo-github-pages/</guid><description>&lt;h2 id="dns-の設定">DNS の設定&lt;/h2>
&lt;p>&lt;code>d.oppara.tv&lt;/code>の CNAME を&lt;code>oppara.github.io&lt;/code>に設定する。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% dig d.oppara.tv @8.8.8.8
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>;; ANSWER SECTION:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>d.oppara.tv. 3600 IN CNAME oppara.github.io.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>oppara.github.io. 3600 IN A 185.199.108.153
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>oppara.github.io. 3600 IN A 185.199.111.153
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>oppara.github.io. 3600 IN A 185.199.109.153
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>oppara.github.io. 3600 IN A 185.199.110.153
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="github-actions-を設定する">GitHub Actions を設定する&lt;/h2>
&lt;p>&lt;a href="https://qiita.com/peaceiris/items/d401f2e5724fdcb0759d">GitHub Actions による GitHub Pages への自動デプロイ - Qiita&lt;/a>&lt;/p></description></item><item><title>スムーズに Hugo でブログを書くツール</title><link>https://d.oppara.tv/posts/2022/03/hugo-blog-tool/</link><pubDate>Fri, 11 Mar 2022 14:35:32 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/03/hugo-blog-tool/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>&lt;code>hugo vim editor&lt;/code>で検索していたら以下の b4b4r07 さんの良さげなブログを発見。&lt;/p>
&lt;p>&lt;a href="https://tellme.tokyo/post/2018/10/16/write-blog-smoothly/">スムーズに Hugo でブログを書くツール | tellme.tokyo&lt;/a>&lt;/p>
&lt;p>上記ブログで使用されている &lt;a href="https://github.com/b4b4r07/blog">b4b4r07/blog&lt;/a> を使用するには、以下の環境変数の設定が必要な模様。&lt;/p></description></item><item><title>--editor オプション付きで hugo new するとエラーになる</title><link>https://d.oppara.tv/posts/2022/03/hugo-with-editor/</link><pubDate>Thu, 10 Mar 2022 12:57:57 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/03/hugo-with-editor/</guid><description>&lt;h2 id="問題">問題&lt;/h2>
&lt;p>&lt;code>--editor&lt;/code> オプション付きで &lt;code>hugo new&lt;/code> すると以下のエラーになってしまう。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% hugo new posts/2022/03/hoge/index.md --editor vim
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content &amp;#34;/path/to/hugo/content/posts/2022/03/hoge/index.md&amp;#34; created
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Editing &amp;#34;/path/to/hugo/content/posts/2022/03/hoge/index.md&amp;#34; with &amp;#34;vim&amp;#34; ...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Error: access denied: &amp;#34;vim&amp;#34; is not whitelisted in policy &amp;#34;security.exec.allow&amp;#34;;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>the current security configuration is:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>[security]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> enableInlineShortcodes = false
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> [security.exec]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> allow = [&amp;#39;^dart-sass-embedded$&amp;#39;, &amp;#39;^go$&amp;#39;, &amp;#39;^npx$&amp;#39;, &amp;#39;^postcss$&amp;#39;]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> osEnv = [&amp;#39;(?i)^(PATH|PATHEXT|APPDATA|TMP|TEMP|TERM)$&amp;#39;]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span> [security.funcs]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> getenv = [&amp;#39;^HUGO_&amp;#39;]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span> [security.http]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> methods = [&amp;#39;(?i)GET|POST&amp;#39;]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> urls = [&amp;#39;.*&amp;#39;]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="対応方法">対応方法&lt;/h2>
&lt;p>以下の設定を &lt;code>confg.toml&lt;/code> に追加する。&lt;/p></description></item><item><title>Hugo の設定</title><link>https://d.oppara.tv/posts/2022/03/hugo-config/</link><pubDate>Wed, 09 Mar 2022 11:14:47 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/03/hugo-config/</guid><description>&lt;p>&lt;a href="https://gohugo.io/getting-started/configuration/">Configure Hugo | Hugo&lt;/a>&lt;/p>
&lt;h2 id="日本語周り">日本語周り&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-toml" data-lang="toml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># デフォルトの言語設定&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">defaultContentLanguage&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;ja&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># &amp;lt;language&amp;gt; エレメント用の値&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">languageCode&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;ja&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 日本語の文字数を正しく数えて、短いサマリーを表示できるようにする&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">hasCJKLanguage&lt;/span> = &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># リスト内のタイトルを複数化しない&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">pluralizeListTitles&lt;/span> = &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># timezone&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">timeZone&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;Asia/Tokyo&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="テーマ-papermod-の設定">テーマ &lt;a href="https://github.com/adityatelange/hugo-PaperMod/wiki/Variables">PaperMod&lt;/a> の設定&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-toml" data-lang="toml">&lt;span style="display:flex;">&lt;span>[&lt;span style="color:#a6e22e">Params&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># 著者名&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">author&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;oppara&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># 日付のフォーマット&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">dateformat&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;2006-01-02&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># リストページに表示される投稿毎の要約を非表示にする&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">hideSummary&lt;/span> = &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># リストページに1つめに表示される投稿のデザインを他の投稿のデザインと同じにする&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">disableSpecial1stPost&lt;/span> = &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># 投稿ページで目次を表示する&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">ShowToc&lt;/span> = &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># パン屑メニューを表示する&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">ShowBreadCrumbs&lt;/span> = &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># 投稿ページの下部にナビゲーションリンクを表示する&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">ShowPostNavLinks&lt;/span> = &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="環境">環境&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% sw_vers
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ProductName: macOS
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ProductVersion: 12.2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>BuildVersion: 21D49
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>% hugo version
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>hugo v0.93.3+extended darwin/amd64 BuildDate=unknown
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Hugo 事始め</title><link>https://d.oppara.tv/posts/2022/03/hugo-quick-start/</link><pubDate>Tue, 08 Mar 2022 00:39:07 +0900</pubDate><guid>https://d.oppara.tv/posts/2022/03/hugo-quick-start/</guid><description>&lt;h2 id="はじめに">はじめに&lt;/h2>
&lt;p>&lt;a href="https://gohugo.io/getting-started/quick-start/">Quick Start | Hugo&lt;/a>&lt;/p>
&lt;p>とりあえずテーマをインストールしてコンテンツを表示するところまで。&lt;/p>
&lt;h2 id="hugo-のインストール">Hugo のインストール&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% brew install hugo
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="サイトの作成">サイトの作成&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% hugo new site d.oppara.tv
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="テーマの追加">テーマの追加&lt;/h2>
&lt;p>&lt;a href="https://github.com/adityatelange/hugo-PaperMod">PaperMod&lt;/a> というテーマを使ってみる。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% cd d.oppara.tv
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% git init
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% git add .
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% git commit -m &lt;span style="color:#e6db74">&amp;#39;feat: initial commit&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% git submodule add https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% echo theme &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">\&amp;#34;&lt;/span>PaperMod&lt;span style="color:#ae81ff">\&amp;#34;&lt;/span> &amp;gt;&amp;gt; config.toml
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% git add .
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% git commit -m &lt;span style="color:#e6db74">&amp;#39;fead: add theme&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="テーマの更新">テーマの更新&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% git submodule update --remote --merge
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="テーマの削除">テーマの削除&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% git submodule deinit -f themes/PaperMod
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% git rm -f themes/PaperMod
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% rm -rf .git/modules/themes*
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="コンテンツの作成">コンテンツの作成&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>% hugo new posts/hoge.md
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% echo &lt;span style="color:#e6db74">&amp;#39;hogehoge&amp;#39;&lt;/span> &amp;gt;&amp;gt; content/posts/hoge.md
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>.hugo_build.lock&lt;/code>をバージョン管理外にする。&lt;/p></description></item></channel></rss>